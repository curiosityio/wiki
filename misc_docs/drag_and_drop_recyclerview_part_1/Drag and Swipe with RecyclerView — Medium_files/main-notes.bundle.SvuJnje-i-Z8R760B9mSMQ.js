(function(z){
'use strict';var k$=function(a){z.A.call(this);this.s(a)},Bva=function(a,b){var c=b.g();if(c===Number||c.$isProtoEnum)return c=Number(a),Number.isNaN(c)?void 0:c;if(c===Boolean)return Boolean(a);if(c===String)return String(a)},Cva=function(a,b){this.user=a;this.quotes=b},l$=function(a){return a.xy.best||null},m$=function(){this.Ox=1},n$=function(a){z.A.call(this);this.xb={};this.s(a)},Dva=function(a,b){return z.y(a,"slots",b)},Eva=function(a,b){return z.y(a,"requestContext",b)},o$=function(a){z.A.call(this);
this.s(a)},p$=function(a,b){b=b.filter(function(a){return"anon"!=a.Ra()});var c=z.$a(b,function(a){return a.Ra()},a);return z.eb(c).map(function(a){return new Cva(a[0].Vb(),a)},a)},Fva=function(a,b,c,d){return(0,z.Nc)(a.Lo[b.name]||[],function(a){return a.nc()==c&&a.$c()==d})},q$=function(a){return z.x(a,"inResponseToMediaResource")},r$=function(a){return z.x(a,"mediumQuote")},s$=function(a,b){return l$(a)?z.WF(l$(a)).filter(function(a){return this.$M(a)==b},a):[]},Gva=function(a,b,c){var d=a.l.w(z.HM,
{postId:b},{filter:c});return z.CJ(a,d,function(){return this.Va.cn(d)})},Hva=function(a,b){var c=a.l.w(z.Oka,{postId:b});return z.CJ(a,c,function(){return this.Va.cn(c)})},Iva=function(a){z.QA(a.va,z.Sl("",a.Gp()))},Jva=function(a,b,c){c=c.ns;b=b.getAttribute("name").split(" ");var d=z.pb(b);a=(a.Lo[c.name]||[]).filter(function(a){return d[a.zg()]});return a.length?z.aG(a):null},Kva=function(a,b,c,d){b=Fva(a,b,c,d);return p$(a,b)},Lva=function(a,b){var c=0;(a.Lo[b]||[]).forEach(function(a){"anon"==
a.Ra()&&(c+=a.fd())});return c},t$=function(a){return z.x(a,"replies")},Mva=function(a,b){z.Pn(a,7);var c=new z.Gn("",1,a.ha());b.forEach(function(a){z.Nn(c,z.bo(a.startOffset,a.endOffset,[a.quoteId],[a.userId]))},a);for(var d=z.Yn(c),e=z.Zn(c,d),g=0;g<d.length;g++){var h=e[g];if(h.length){for(var k={},n=[],p=0;p<h.length;p++){var u=h[p];k[z.x(u,"creatorIds")]=!0;n.push(u.getName())}h=d[g];p=g<d.length-1?d[g+1]:a.ha().length;z.Nn(a,z.bo(h,p,n,Object.keys(k)))}}},u$=function(a,b,c){b="";var d=!a.Vea&&
(null==a.post.virtuals?null:null==a.post.virtuals.previewImage?null:a.post.virtuals.previewImage.imageId),e=""+(a.rb?"95":"85"),e=z.E(e),g=""+(d?z.H(z.mp({image:a.post.virtuals.previewImage,strategy:"crop-fixed",width:e,height:e},0,c)):""),g=(0,z.L)(g),e=""+z.H(z.No(z.D(a,{post:a.post,source:a.Ew}),0,c)),e=(0,z.L)(e),h="u-block"+(a.bA?" u-width400 u-tableCell u-verticalAlignMiddle"+(a.rb?" u-height95":" u-height85"):""),h=z.E(h),k="readNextPromo-postInfo"+(a.bA?" u-tableCell u-verticalAlignMiddle u-paddingRight0":
""),k=z.E(k),n="readNextPromo-postTitle u-block"+(a.bA?" u-lineClamp2":" u-noWrapWithEllipsis"),n=z.E(n),d='\x3cdiv class\x3d"'+z.G(k)+'"\x3e'+(a.Ega?'\x3cspan class\x3d"readNextPromo-callToAction u-accentColor--textNormal"\x3e'+z.F((0,z.B)("Next story"))+"\x3c/span\x3e":"")+'\x3ch4 class\x3d"'+z.G(n)+'"\x3e'+z.C(a.post.title)+"\x3c/h4\x3e"+(a.Sea?"":'\x3cspan class\x3d"readNextPromo-authorName u-block u-noWrapWithEllipsis u-fontSize13 '+(d?" u-maxWidth200":"")+'"\x3e'+z.C(a.post.creator.name)+"\x3c/span\x3e")+
"\x3c/div\x3e"+(d?'\x3cdiv class\x3d"readNextPromo-coverImage u-tableCell"\x3e\x3cimg class\x3d"readNextPromo-image'+(a.rb?" u-height95 u-width95":"")+'" src\x3d"'+z.G(z.Im(g))+'" /\x3e\x3c/div\x3e':""),d=(0,z.M)(d),g="readNextPromo"+(a.rb?" u-height95":"")+(a.ca?" u-height44 readNextPromo--chromeless":"")+(a.C?" "+z.C(a.C):""),g=(0,z.M)(g);b+='\x3cdiv class\x3d"'+z.G(g)+'"\x3e'+(a.Rea?'\x3cdiv class\x3d"buttonSet-separator buttonSet-separator--readNext u-floatLeft u-verticalAlignTop js-postActionRightSeparator"\x3e\x3c/div\x3e':
"")+z.F(z.V({href:e,D:d,vk:!0,C:h},c))+"\x3c/div\x3e";return(0,z.B)(b)},Nva=function(a,b,c){b=z.B;a=a.Yda?"Top highlight":(0,z.B)(z.F(z.aS(z.D(a,{RN:!0,L_:!c.useragent.isMobile}),c))+(1==a.hg&&a.isActive?" highlighted":""));return b(a)},v$=function(a,b){this.Vf=a;this.R3=b;var c=z.PC(a.node,b);this.ld=(this.Zh=c)&&c.getAttribute("name");this.PC=c?z.lu(a,c):-1},w$=function(a,b){return(0,z.B)(a.post?'\x3cdiv class\x3d"relatedPost col u-padding5 u-xs-size12of12 u-size6of12"\x3e'+u$({post:a.post,Ew:z.E(""+
z.Yz({name:"related-reads-footer-grid",index:a.index})),bA:!0,rb:!0},0,b)+"\x3c/div\x3e":"")},Ova=function(a,b,c){b=z.F(z.Bw({action:"sidecard-dismiss",JN:!0,C:"u-fontSizeLarge u-marginRight5"},c))+'\x3ch1 class\x3d"u-padding10 u-fontSizeSmallest u-textColorDark u-backgroundGrayLightest"\x3e'+z.F((0,z.B)("More good reads"))+"\x3c/h1\x3e\x3cul\x3e";a=a.posts;for(var d=a.length,e=0;e<d;e++){var g=a[e];b+='\x3cli class\x3d"u-borderTopLightest"\x3e'+z.F(z.V({href:(0,z.L)(""+z.H(z.No({post:g},0,c))),isPrimary:!0,
D:(0,z.M)('\x3cdiv class\x3d"u-fontSizeSmall u-contentTextBold u-lineClamp2 u-block u-paddingTop10 u-paddingLeft10 u-paddingRight10"\x3e'+z.C(g.title)+'\x3c/div\x3e\x3cdiv class\x3d"u-fontSizeSmaller u-alignMiddle u-paddingBottom10 u-paddingLeft10 u-paddingRight10 u-textColorNormal"\x3e'+z.C(g.creator.name)+"\x3c/div\x3e")},c))+"\x3c/li\x3e"}return(0,z.B)(b+"\x3c/ul\x3e")},Pva=function(a,b,c){return(0,z.B)(z.k_(z.D(a,{user:c.currentUser,type:"quoteResponses"}),c))},x$=function(a,b){z.R.call(this);
this.ea=a;this.Caa=b;this.CU=this.ex=!1},y$=function(a,b,c,d){z.R.call(this);this.hD=c;this.Wo=null;this.za=d;this.tS=!1;this.rc=a.get("element-tracker");this.wB=z.ju(this.za.Df).height;this.Ha(this.fx(b))},Qva=function(a,b,c){return(0,z.B)('\x3cdiv\x3e\x3cdiv class\x3d"buttonSet buttonSet--highlightMenu"\x3e'+z.F(z.zw({action:"quote",source:"quote_popover",icon:(0,z.M)(""+z.F(z.Ix())),C:"button--highlightMenu u-accentColor--highlightStrong js-quoteAttributions-pileOn",Wb:!0,zj:!0,TL:"quote",ca:!0,
isActive:a.isActive},c))+(c.supportsEdit?z.F(z.zw({action:"quote-respond",source:"quote_popover",icon:(0,z.M)(""+z.F(z.ky())),C:"button--highlightMenu",Wb:!0,ca:!0},c)):"")+'\x3cdiv class\x3d"buttonSet-separator"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"js-quoteAttributions-info quoteAttributions-info"\x3e'+Nva(a,0,c)+"\x3c/div\x3e\x3c/div\x3e")},z$=function(a){z.od.call(this);var b=z.eh();this.wh=b&&new v$(z.Wh(b,!0),a);this.Xi=b&&new v$(z.Wh(b,!1),a)},Rva=function(a,b,c){b="";for(var d=a.posts,
e=d.length,g=0;g<e;g++)b+=u$({post:d[g],Ew:a.source,bA:!0,C:"u-margin5 u-overflowHidden u-whitespaceNormal u-inlineBlock"},0,c);return(0,z.B)(b)},Sva=function(a,b,c){b=z.B;var d='\x3cdiv class\x3d"relatedPostGridContainer"\x3e\x3cdiv class\x3d"relatedPostGrid container u-maxWidth740"\x3e'+z.F(z.Gy({title:z.E(""+(0,z.B)("Related reads")),sn:!0,C:"u-margin10 u-fontSizeSmaller u-textColorDark"},c))+'\x3cdiv class\x3d"row"\x3e',e;e={post:a.postPromotion.post,Ew:z.E(""+z.Yz({name:"related-reads-footer-grid",
index:0})),postPromotion:a.postPromotion};var g="";if(e.post){var g=g+'\x3cdiv class\x3d"relatedPost col u-padding5 u-xs-size12of12 u-size6of12"\x3e',h=null==e.post.virtuals?null:null==e.post.virtuals.previewImage?null:e.post.virtuals.previewImage.imageId,k=""+(h?z.H(z.mp({image:e.post.virtuals.previewImage,strategy:"crop-fixed",width:95,height:95},0,c)):""),k=(0,z.L)(k),n=""+z.H(z.No(z.D(e,{post:e.post,source:e.Ew}),0,c)),n=(0,z.L)(n),p;p=z.E("u-block u-width400 u-tableCell u-verticalAlignMiddle u-height95");
var u;u=z.E("readNextPromo-postInfo u-tableCell u-verticalAlignMiddle u-paddingRight0");var w;w=z.E("readNextPromo-postTitle u-block u-noWrapWithEllipsis u-marginTop0"+(h?" u-maxWidth200":""));h='\x3cdiv class\x3d"'+z.G(u)+'"\x3e\x3cdiv class\x3d"postPromotion-sponsoredHeading u-fontSize13"\x3e'+z.F(z.WG())+" "+z.F(z.zw({action:"show-promoted-stories-popover",ca:!0,$z:!0,icon:(0,z.M)(""+z.F(z.hy()))},c))+'\x3c/div\x3e\x3ch4 class\x3d"'+z.G(w)+'"\x3e'+z.C(e.post.title)+'\x3c/h4\x3e\x3cspan class\x3d"readNextPromo-authorName u-block u-noWrapWithEllipsis u-fontSize13 '+
(h?" u-maxWidth200":"")+'"\x3e'+z.C(e.post.creator.name)+"\x3c/span\x3e\x3c/div\x3e"+(h?'\x3cdiv class\x3d"readNextPromo-coverImage u-tableCell"\x3e\x3cimg class\x3d"readNextPromo-image u-height95 u-width95" src\x3d"'+z.G(z.Im(k))+'" /\x3e\x3c/div\x3e':"");h=(0,z.M)(h);k=(0,z.M)("readNextPromo u-height95 js-trackedPostPromotion js-postPromotionWrapper");g+='\x3cdiv class\x3d"'+z.G(k)+'" data-post-id\x3d"'+z.G(e.postPromotion.postId)+'" data-source\x3d"'+z.G(e.Ew)+'" data-post-promotion-source\x3d"'+
z.G(e.postPromotion.promotionSource)+'" data-action\x3d"open-post-promotion" data-location-id\x3d"post_footer_related_reads"\x3e'+z.F(z.V({href:n,D:h,vk:!0,C:p},c))+"\x3c/div\x3e\x3c/div\x3e"}e=(0,z.B)(g);return b(d+e+w$({post:a.posts[0],index:1},c)+'\x3c/div\x3e\x3cdiv class\x3d"row"\x3e'+w$({post:a.posts[1],index:2},c)+w$({post:a.posts[2],index:3},c)+"\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e")},Tva=function(a,b,c){return(0,z.B)('\x3cdiv class\x3d"relatedPostGridContainer"\x3e\x3cdiv class\x3d"relatedPostGrid container u-maxWidth740"\x3e'+
z.F(z.Gy({title:z.E(""+(0,z.B)("Related reads")),sn:!0,C:"u-margin10 u-fontSizeSmaller u-textColorDark"},c))+'\x3cdiv class\x3d"row"\x3e'+w$({post:a.posts[0],index:0},c)+w$({post:a.posts[1],index:1},c)+'\x3c/div\x3e\x3cdiv class\x3d"row"\x3e'+w$({post:a.posts[2],index:2},c)+w$({post:a.posts[3],index:3},c)+"\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e")},Uva=function(a,b,c){return(0,z.B)('\x3cdiv class\x3d"postBundle"\x3e\x3cdiv class\x3d"container u-maxWidth740"\x3e\x3cdiv class\x3d"supplementalPostContent relatedReadsStream js-relatedReadsStream u-maxWidth640"\x3e'+
z.F(z.DS(a,0,c))+"\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e")},A$=function(a){z.R.call(this);this.$q=this.za=this.ea=null;this.xa=a.get("screen");this.Aa=null;this.X=a},B$=function(a,b,c){z.R.call(this);this.Yc=a.get("quotes-data");var d=this.Yc.bl;d.subscribe("add",this.tU,this);d.subscribe("remove",this.tU,this);this.za=b;this.Mc=b.Df;this.al=c;this.zR=[];this.va=a.get("app");this.ka=a.get("popover");this.l=a.get("route-builder");this.GI=a.get("global-event-bus");this.o9=a.get("progressive-media-loader")},
Wva=function(a,b,c,d){var e=Vva(a,b);e&&(c=z.tE(z.vE(z.sE(z.uE(z.rE(a.ka).Ma(Qva,e),"top"),c),"popover--dark popover--padding0 popover--flexible popover--quoteAttributions"),d).W())&&(c.Bj("deactivate",function(){this.Im===b&&C$(this,null)},a),z.kE(c).o("quote",a.K4.bind(a,c)).o("quote-respond",a.L4.bind(a,c)))},Vva=function(a,b){if("anon"==b.Ra())return{isActive:!1,Yda:!0};var c=D$(a,b),d=b.nc(),e=b.$c(),c=Kva(a.Yc,c,d,e);if(!c||!c.length)return null;c=(0,z.qb)(c,function(a){return a.user});d=(0,z.Nc)(c,
function(a){return a.userId!=z.Pk().userId});return{isActive:(0,z.zc)(c,function(a){return a.userId==z.Pk().userId}),social:d,hg:c.length}},Xva=function(a,b){var c=a.Mc.querySelectorAll('.markup--quote[name~\x3d"'+b.zg()+'"]');return z.Ra(c)},D$=function(a,b){var c=b.Bb()[0].name;return(c=z.Ot(a.Mc,c))?a.za.yg(c):null},Yva=function(a,b){var c=z.fh(b);return(c=z.lG(a.al,c))?Jva(a.Yc,b,c):null},C$=function(a,b){a.Im!==b&&(a.Im&&Zva(a,a.Im,!1),b&&Zva(a,b,!0),a.Im=b)},Zva=function(a,b,c){Xva(a,b).map(function(a){z.Rc(a,
"is-targeted",c)})},E$=function(a,b){var c=b.Bb(),d=z.Ot(a.Mc,c[0].getName()),c=z.Ot(a.Mc,z.Ja(c).getName());(d=z.LF(d,b.nc(),c,b.$c()))&&z.jG(a.Jh(),d)},F$=function(a,b,c,d){z.T(c?z.VM:z.Rla,{postId:a.za.ua(),quoteId:b,source:d})},$va=function(a,b){z.SC(a,z.RC,z.Ib(b,z.Eb(!0)),void 0)},G$=function(a){z.Wu.call(this);this.ub=a.get("dom-model-converter");this.CT={};this.AS={};this.bK={};this.X=a;this.dl=a.get("request");this.l=a.get("route-builder");this.ba=a.get("model-store");this.Ca="";this.YT=
0;this.xR=!1;this.Pk=null},H$=function(a,b){var c=a.CT[b];c||(c=a.CT[b]=new z.RF,a.aa("new_note_list",c,a));return c},awa=function(a,b){if(!b)return!1;var c=b.ha();if(a.content==c.substring(a.startIndex,a.endIndex))return!0;var d=new RegExp(z.Aa(a.content),"gi"),e=d.exec(c),c=e&&d.exec(c);return e&&!c?(c=a.endIndex-a.startIndex,a.startIndex=e.index,a.endIndex=e.index+c,a.content=e[0],!0):!1},I$=function(a,b,c){var d=b.ua(),e=b.Re(),g=H$(a,b.Kc()),h=g?g.indexOf(b):-1,k=b.Dz();b.Zs(c);"HIDDEN"==c?a.ba.remove(b):
b=z.AF(a.ba,b);var n=g?g.indexOf(b):-1;return{ri:a.dl.put(a.l.w(z.dka,{postId:d,noteId:e}),{state:c}),tA:function(){b.Zs(k);-1==n&&(-1==h?g.add(b):z.TF(g,b,h))}}},J$=function(a,b,c,d,e,g){var h=t$(a.Fl(c,e)),k=z.Ka(h,function(a){return a.gs()==b}),n=h[k];"HIDDEN"==g&&z.Oa(h,k);c=a.l.w(z.gka,{postId:d,noteId:c,replyId:b});a=a.dl.put(c,{state:g});var p=z.Ka(h,function(a){return a.gs()==b});return{ri:a,tA:function(){-1==p&&z.Va(h,k,0,n)}}},bwa=function(a,b,c){this.range=a;this.anchor=b;this.Gr=b.getAttribute("name");
this.highlight=c},K$=function(a,b,c){z.R.call(this);this.R9=b;this.f9=c;this.xa=a.get("screen");this.Ba=a.get("screen-request")},L$=function(a){z.R.call(this);this.ea=null;this.Ba=a.get("screen-request");this.X=a},cwa=function(){},Bwa=function(a){this.OC=a},M$=function(a,b){return b?z.Ot(a.OC,b):null},Cwa=function(a,b,c){$va(a.OC,function(a){var e=a.getAttribute("name");e&&b.call(c,a,e)})},Dwa=function(a,b){return z.Hf(a.OC,b)?a.OC:null},N$=function(a,b,c,d,e){z.sZ.call(this,a,b);this.Ga(new z.dY(c));
this.Ga(new z.b_(!1));this.Ga(new z.e_(a));this.Ga(new z.tZ);this.Ga(new z.h_(!1));this.Ga(new z.z_(d,!0));this.ng=!0;this.dj=d;this.dl=a.get("request");this.ia=a.get("dialog");this.MJ=e;this.W()},Ewa=function(){return(0,z.B)("Write a note…")},O$=function(a,b,c,d,e){N$.call(this,a,b,e||"Leave a note",400,d||null);this.Ca=c;this.l=a.get("route-builder");this.Od=a.get("notes-data")},P$=function(a,b,c,d,e,g){N$.call(this,a,b,"Leave a reply…",200,d);this.l=a.get("route-builder");this.Od=a.get("notes-data");
this.Ca=c;this.pU=g||null;this.ld=e},Gwa=function(a,b,c){var d='\x3cdiv class\x3d"quoteResponses js-quoteResponses"\x3e',e=a.quotes.length,g=a.responses.length||a.gQ;b=a.notes.length||a.BG;if(e||g||b){if(e){var e='\x3cdiv class\x3d"quoteResponses-section"\x3e'+z.F(z.Hy({title:(0,z.M)(z.F((0,z.B)("Highlights"))+" ("+z.C(a.quotes.length)+")"),Jd:!0},c)),h;h={WZ:a.quotes,yha:!0};for(var k='\x3cdiv class\x3d"js-quotesList"\x3e'+(h.yha?"":z.F(z.Hy({title:(0,z.M)(""+z.F((0,z.B)("Highlights"))),Jd:!0,xd:(0,z.M)(""+
z.F(z.Fy({href:(0,z.L)(""+z.H((0,z.Mo)("https://medium.com/the-story/introducing-highlights-a4df69e8ed43"))),moreText:"Learn more",Ib:!0},c)))},c))),n="list list--quotes list--short"+(h.WZ.length?"":" is-empty"),n=(0,z.M)(n),k=k+('\x3cul class\x3d"'+z.G(n)+'"\x3e'),n=h.WZ,p=n.length,u=0;u<p;u++){for(var w=n[u],I="",J=w.quotes,P=J.length,S=0;S<P;S++)I+=""+J[S].quoteId+(S!=P-1?",":"");I=z.E(I);k+='\x3cli class\x3d"list-item list-item--inline" data-quote-ids\x3d"'+z.G(I)+'" data-quote-creator-id\x3d"'+
z.G(w.user.userId)+'" data-action\x3d"highlight-quote" data-action-type\x3d"hover"\x3e'+z.F(z.xy(z.D(h,{user:w.user,jm:!0}),c))+"\x3c/li\x3e"}h=(0,z.B)(k+"\x3c/ul\x3e\x3c/div\x3e");e=e+z.C(h)+"\x3c/div\x3e"}else e="";g?(g='\x3cdiv class\x3d"quoteResponses-section'+(a.gQ?" is-withEditor":"")+'"\x3e'+z.F(z.Hy({title:(0,z.M)(""+z.F((0,z.B)("Responses"))),Jd:!0},c)),a.gQ&&c.supportsEdit&&c.isAuthenticated?(h={},h=(0,z.B)('\x3cdiv class\x3d"js-inlineNewPostControl inlineNewPostControl inlineNewPostControl--quoteResponses blockGroup blockGroup-list"\x3e'+
z.k_(z.D(h,{user:c.currentUser,isCollapsed:!0,ws:!0,type:"quoteResponses",aq:(0,z.M)(""+z.F((0,z.B)("Respond here…")))}),c)+"\x3c/div\x3e"),h=z.C(h)):h="",g=g+h+Fwa(a,0,c)+"\x3c/div\x3e"):g="";d+=e+g;if(a.Ffa&&b){d+='\x3cdiv class\x3d"quoteResponses-section quoteResponses-section--fullBleed"\x3e';b="";g=a.post.homeCollection;g=""+("Private notes are visible to you"+(a.post.creator.userId!=c.currentUser.userId?", the author,":"")+" and the editors of "+(g?z.C(g.name):"any publication this story is added\x26nbsp;to")+
".");g=(0,z.B)(g);g=""+z.C(g);g=(0,z.M)(g);b+='\x3cspan data-tooltip\x3d"'+z.G(g)+'"\x3eWho can see this?\x3c/span\x3e';g={};g=(0,z.B)(z.rx(z.D(g,{name:"lock",size:"19px",content:(0,z.M)('\x3csvg class\x3d"svgIcon-use" width\x3d"19" height\x3d"19" viewBox\x3d"0 0 19 19" \x3e\x3cpath d\x3d"M14 14.052a1 1 0 0 1-.992.998H5.992A.99.99 0 0 1 5 14.052v-4.004a1 1 0 0 1 .992-.998h7.016a.99.99 0 0 1 .992.998v4.004zM7 5.445C7 4.187 8.114 3.15 9.5 3.15c1.385 0 2.5 1.04 2.5 2.295V8.05H7V5.445zm6.008 2.605H13V5.445c0-1.822-1.578-3.295-3.5-3.295C7.577 2.15 6 3.618 6 5.445V8.05h-.008A2 2 0 0 0 4 10.048v4.004a1.99 1.99 0 0 0 1.992 1.998h7.016A2 2 0 0 0 15 14.052v-4.004a1.99 1.99 0 0 0-1.992-1.998z" fill-rule\x3d"evenodd"/\x3e\x3c/svg\x3e')})));
b={QP:(0,z.M)(""+z.C(g)),title:(0,z.M)(""+z.F((0,z.B)("Private notes"))),Jd:!0,xd:(0,z.M)(b),C:"heading--privateNotes"};b=(0,z.B)(z.Dy(z.D(b,{Dh:(0,z.M)(""+z.Ey(b,c)),uea:!0})));b=d+=z.C(b);d=""+('\x3cdiv class\x3d"privateNotes-list js-notesList'+(a.BG?" is-showingNoteEditor":"")+(0==a.notes.length?" is-empty":"")+'"\x3e');g=a.notes;e=g.length;for(h=0;h<e;h++)d+=Q$({note:g[h],post:a.post,KA:a.KA},0,c);a.BG?(a=a.post.creator,a=(0,z.B)(c.currentUser.userId==a.userId?"Leave yourself a note":"Send "+
z.C(a.name)+" a private note…"),a='\x3cdiv class\x3d"privateNotes-actions js-noteActions"\x3e'+z.F(z.ww({action:"show-note-editor",text:(0,z.M)(""+z.C(a)),C:"privateNotes-prompt"},0,c)),c=(0,z.B)('\x3cdiv class\x3d"privateNotes-editor"\x3e'+z.F(z.yy({user:c.currentUser,xe:!0},c))+'\x3cdiv class\x3d"js-noteEditor"\x3e\x3c/div\x3e\x3cdiv class\x3d"buttonSet"\x3e'+z.F(z.ww({action:"save-note",isPrimary:!0,C:"js-saveNoteButton",text:(0,z.M)(""+z.F((0,z.B)("Send")))},0,c))+z.F(z.ww({action:"hide-note-editor",
text:(0,z.M)(""+z.F((0,z.B)("Cancel")))},0,c))+"\x3c/div\x3e\x3c/div\x3e"),c=a+c+"\x3c/div\x3e"):c="";c=(0,z.B)(d+("\x3c/div\x3e"+c));d=b+('\x3cdiv class\x3d"quoteResponses-inner privateNotes"\x3e'+c+"\x3c/div\x3e\x3c/div\x3e")}}else 0<a.Fw&&(d+='\x3cdiv class\x3d"quoteResponses-section quoteResponses-section--fullBleed quoteResponses-section--tips u-textAlignCenter"\x3e\x3cdiv class\x3d"quoteResponses-section--tipsInner u-alignMiddle"\x3e'+z.F(z.zw({rb:!0,pe:!0,ca:!0,action:"previous-highlight-tip",
icon:(0,z.M)(""+z.F(z.vx())),title:(0,z.M)("Show previous tip")},c))+"\x3cdiv class\x3d'u-alignBlock quoteResponses-section--tipsContent js-highlightTip'\x3e\x3c/div\x3e"+z.F(z.zw({rb:!0,pe:!0,ca:!0,action:"next-highlight-tip",icon:(0,z.M)(""+z.F(z.xx())),title:(0,z.M)("Show next tip")},c))+"\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e");return(0,z.B)(d+"\x3c/div\x3e")},Fwa=function(a,b,c){return(0,z.B)(z.F(z.rS({source:"quoteResponses",count:a.responses.length,posts:a.responses,pc:!0,hd:!0,gh:!0,MN:!0,Uea:!0,
Dg:!0,Ve:!0,yda:!0},c)))},Q$=function(a,b,c){var d,e=null==a.note.replies?null:a.note.replies.length,g=null==a.note.replyId,h=a.post.creator.userId==c.currentUser.userId,k=a.post.creator.userId==a.note.author.userId;d=a.note.author.userId==c.currentUser.userId;b=h||(null==a.post.homeCollection?null:a.post.homeCollection.virtuals.permissions.canEditPosts);var n=""+(g?"js-note-item"+(a.note.noteId?" js-note-"+a.note.noteId:""):"js-reply-item"+(a.note.replyId?" js-reply-"+a.note.replyId:"")),n=z.E(n),
p="",h='\x3cdiv class\x3d"privateNotes-item '+z.G(n)+' js-note" data-note-id\x3d"'+z.G(a.note.noteId)+'"\x3e'+(g?z.F(z.xy({user:a.note.author},c)):z.F(z.vy({user:a.note.author},c)))+'\x3cdiv class\x3d"privateNotes-authorLockup"\x3e\x3cdiv class\x3d"privateNotes-author"\x3e'+z.F(z.Gw({user:a.note.author},c))+(g||!(h||d||(null==a.post.homeCollection?0:a.post.homeCollection.virtuals.permissions.canEditPosts))||k||a.CY?"":'\x3cspan class\x3d"privateNotes-author--supplemental"\x3e '+z.F((0,z.B)("(Editor)"))+
"\x3c/span\x3e")+'\x3c/div\x3e\x3cdiv class\x3d"privateNotes-supplemental"\x3e'+z.F(z.Aq(Number(a.note.createdAt),c))+'\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"privateNotes-content js-privateNotesContent"\x3e',k=z.F(z.lr(String(a.note.content),c)),n=String(k).replace(/(\r\n|\r|\n)/g,"\x3cbr\x3e"),k=z.Wl(k,z.Zl)?(0,z.B)(n,z.Xl(k)):n;d=p+(h+k+"\x3c/div\x3e"+(d?Hwa({note:a.note,isPrimary:g},c):""));if(g){d+='\x3cdiv class\x3d"privateNotes-replies'+(e?"":" is-empty")+' js-repliesList"\x3e';if(e)for(e=
a.note.replies,g=e.length,p=0;p<g;p++)h=e[p],d+=Q$({note:h,post:a.post,CY:a.note.author.userId==h.author.userId},0,c);e=d;g="\x3c/div\x3e"+(a.KA?(0,z.B)('\x3cdiv class\x3d"privateNotes-editor privateNotes-editor--reply"\x3e'+z.F(z.wy({user:c.currentUser,xe:!0},c))+'\x3cdiv class\x3d"js-replyEditor"\x3e\x3c/div\x3e\x3cdiv class\x3d"buttonSet"\x3e'+z.F(z.ww({action:"save-reply",isPrimary:!0,text:(0,z.M)(""+z.F((0,z.B)("Send")))},0,c))+z.F(z.ww({action:"hide-reply-editor",text:(0,z.M)(""+z.F((0,z.B)("Cancel")))},
0,c))+"\x3c/div\x3e\x3c/div\x3e"):"")+'\x3cdiv class\x3d"privateNotes-actions'+(b?" privateNotes-actions--withDismiss":"")+' u-clearfix"\x3e';d=a.KA?'\x3cdiv class\x3d"u-floatLeft"\x3e'+(0,z.B)(z.F(z.ww({isPrimary:!0,action:"show-reply-editor",C:"privateNotes-prompt",text:(0,z.M)(""+z.F((0,z.B)("Reply")))},0,c)))+"\x3c/div\x3e":"";d=e+(g+d+(b?'\x3cdiv class\x3d"u-floatRight"\x3e'+Hwa({note:a.note,isPrimary:!0,jY:!0},c)+"\x3c/div\x3e":"")+"\x3c/div\x3e")}return(0,z.B)(d+"\x3c/div\x3e")},Hwa=function(a,
b){return(0,z.B)(z.F(z.ww({actionValue:a.isPrimary?a.note.noteId:a.note.replyId,action:a.jY?"dismiss-note":a.isPrimary?"delete-note":"delete-reply",C:"privateNotes-delete js-deleteNote",text:(0,z.M)(""+(a.jY?z.F((0,z.B)("Dismiss note")):z.F((0,z.B)("Delete"))))},0,b)))},Iwa=function(a,b,c){return(0,z.B)(0==a.mf?(1==a.Fw?"People":z.C(a.Fw)+" people")+' highlighted this passage. You can click on an existing highlight to add to it, like below:\x3cimg class\x3d"quoteResponses-tipAnimation" src\x3d"'+
z.G(z.Im(z.mr("/img/help/highlight-tips-2.gif",c.fp)))+'"\x3e':1==a.mf?'Or, select any passage to create your own highlight and tell the author and others what resonated with you:\x3cimg class\x3d"quoteResponses-tipAnimation" src\x3d"'+z.G(z.Im(z.mr("/img/help/highlight-tips-1.gif",c.fp)))+'"\x3e':2==a.mf?z.F(z.V({bd:!0,Wb:!0,source:"highlight_tip",D:"Sign in to create a profile",href:(0,z.L)(""+z.H(z.To(c)))},c))+" so that you can save your highlights and share them with others.":"")},R$=function(a,
b,c,d,e,g,h,k){z.R.call(this);this.X=a;this.fa=a.get("butter-bar");this.za=b;this.ld=c;this.ph=e;this.Yc=a.get("quotes-data");this.Od=a.get("notes-data");this.Rg=a.get("responses-data");this.Cd=g;this.MJ=d;this.rK=(this.ry=h)?h.zg():null;this.he=this.nd=null;this.uh={};this.LS=!!z.Rk();this.MS=!!z.Tk();this.ju=this.LS&&this.MS&&z.qH(b);this.vm=null;this.hC=0;this.iV=Lva(this.Yc,this.ld);this.Uq=k;this.Ha(this.fx())},Jwa=function(a){a.ib(".js-block").forEach(function(a){this.pa(a,"mouseenter",this.i5,
this);this.pa(a,"mouseleave",this.tL,this)},a)},Kwa=function(a){a.ib(".js-note").forEach(function(a){this.pa(a,"mouseenter",this.g5,this);this.pa(a,"mouseleave",this.tL,this)},a)},Lwa=function(a,b){var c=a.query(".js-note-"+b);a.uh[b]||(a.uh[b]=new P$(a.X,c.querySelector(".js-replyEditor"),a.za.ua(),b,a.ld),z.Zu(a,a.uh[b],"saving",a.b8,a),z.Zu(a,a.uh[b],"save",a.W7,a),z.Zu(a,a.uh[b],"fail",a.f7,a));z.t(c,"is-noteEditorVisible");a.uh[b].focus()},Mwa=function(a,b){var c=a.uh[b];c&&(c.Ea()&&c.cd(""),
c=a.query(".js-note-"+b),z.Oc(c,"is-noteEditorVisible"))},Nwa=function(a,b,c){var d=M$(a.Cd,a.ld);if(d){var e=[];a.Uq&&(e=a.Uq.quotes.map(function(a){return a.zg()}));(0,z.qb)(d.querySelectorAll(".markup--quote"),function(a){var d=a.getAttribute("data-creator-ids").split(" "),d=z.Na(d,b);if(this.Uq)var k=a.getAttribute("name").split(" "),d=d&&(0,z.zc)(k,z.Na.bind(null,e));z.Rc(a,"is-selected",c&&d)},a)}},S$=function(a){return(a=z.Kt(a,function(a){return z.Lc(a,"js-note-item")}))&&a.getAttribute("data-note-id")},
Owa=function(a,b,c,d){b=new z.cE(b,300);b.Ha(c);b.subscribe("dismiss",d,a);b.W();return b},T$=function(a){var b=a.Bb(),c=a.nc();a=a.$c();1<b.length&&(a=b[0].ha().length);var d=new z.Uq;d.bm(b[0].getName());d.lf(c);z.y(d,"endIndex",a);d.cd(b[0].ha().substring(c,a));return d},U$=function(a,b){var c=b%3;0>c&&(c=2);a.hC=c;(c=a.query(".js-highlightTip"))&&z.O(c,Iwa,{mf:a.hC,Fw:a.iV})},V$=function(a,b,c,d){z.R.call(this);this.Ha(this.fx(d));this.Za=a.get("dom-monitor");this.za=b;this.QS=!b.Wa().Bp()||b.ad();
this.Ca=b.ua();this.Cd=c;this.Yc=a.get("quotes-data");this.Rg=a.get("responses-data");this.Od=a.get("notes-data");this.Hq=null;this.Gf={}},Pwa=function(a,b){b.forEach(function(a){a&&W$(this,a)},a)},W$=function(a,b){if(!a.Hq)if(M$(a.Cd,b)){var c=Qwa(a,b),c=Rwa(a,c),c=Swa(a,c),c=Twa(a,c);a.Gf[b]=c;Uwa(a,b)}else delete a.Gf[b]},Vwa=function(a,b){if(!a.Hq){var c=a.Gf[b];if(c){var d=c.length,c=Swa(a,c),c=Twa(a,c);a.Gf[b]=c;d!=c.length?Uwa(a,b):c.forEach(function(a){a.wa&&a.offsetTop&&(a.wa.style.top=a.offsetTop+
"px")})}}},Wwa=function(a,b,c){return z.La(a.Gf[b]||[],function(a){return a.wa==c})},Qwa=function(a,b){var c=[];H$(a.Od,b).bf(function(a){var e=a.Av(),g=void 0;e?(g=this.Od.ZE(e),e=g.Ja(),g=z.x(g,"endIndex")):(e=0,g=a.Ea().length);c.push({anchor:b,startIndex:e,endIndex:g,notes:[a],quotes:[],responses:[]})},a);if(a.QS)return c;(a.Yc.Lo[b]||[]).forEach(function(a){var e=Xwa(a);c.push({anchor:b,startIndex:e.startIndex,endIndex:e.endIndex,notes:[],quotes:[a],responses:[]})},a);s$(a.Rg,b).forEach(function(a){var e=
q$(a);e&&(e=r$(e)&&r$(e).nk())&&(e=Xwa(e),c.push({anchor:b,startIndex:e.startIndex,endIndex:e.endIndex,notes:[],quotes:[],responses:[a]}))},a);return c},Rwa=function(a,b){var c=[];b.sort(function(a,b){return a.startIndex-b.startIndex});b.forEach(function(a){var b=z.Ka(c,function(b){return b.endIndex>=a.startIndex-1&&b.startIndex<=a.endIndex+1});0<=b?this.Tx(c[b],a):c.push(a)},a);return c},Twa=function(a,b){var c=[];b.forEach(function(a){if(a.offsetTop){var b=z.Ka(c,function(b){return 30>=Math.abs(b.offsetTop-
a.offsetTop)});0<=b?this.Tx(c[b],a):c.push(a)}},a);return c},Uwa=function(a,b){a.ib(".js-paragraphControl-"+b).forEach(z.Bf);a.Gf[b]=a.Gf[b].map(function(a){var b=Ywa(this,a),b=z.nt(Zwa,b);b.style.top=a.offsetTop+"px";a.wa=b;this.U().appendChild(a.wa);z.t(b,"is-visible");return a},a)},Ywa=function(a,b){var c=b.notes,d=b.responses,e=p$(a.Yc,b.quotes),g=d?d.length:0,h=c?c.length:0,k=0,n=0,p=0,u=!1,w=!1,I={},J={},P=z.Pk().userId,S=a.za.Wa().ze().Ra();c.forEach(function(a){var b=a.Ur();b&&((a=t$(a))&&
a.forEach(function(a){h++;a.author&&(a.author.userId==P&&k++,a.author.social&&a.author.social.isFollowing&&(I[a.author.userId]=a.author),J[a.author.userId]=!0)}),J[b.userId]=!0,b.userId==P&&k++,b.userId==S?n++:p++,b.social&&b.social.isFollowing&&(I[b.userId]=b))});e.forEach(function(a){a=a.user;J[a.userId]=!0;a.userId==P&&(u=!0);a.social&&a.social.isFollowing&&(I[a.userId]=a)});d.forEach(function(a){a=a.ze();J[a.userId]=!0;a.userId==P&&(w=!0);a.social&&a.social.isFollowing&&(I[a.userId]=a)});c=b.quotes.filter(function(a){return"anon"==
a.Ra()});return{postId:a.Ca,Gr:b.anchor,Dfa:h,iga:g,Os:w,Gs:k,xZ:n,Efa:p,Esa:e.length,Ms:u,eY:Object.keys(J).length,Pda:z.eb(I),Fw:c.length}},Xwa=function(a){var b=a.nc(),c=a.$c();1<a.paragraphs.length&&(c=a.paragraphs[0].text.length);return{startIndex:b,endIndex:c}},Swa=function(a,b){var c=z.fu();return b.map(function(a){var b=this.Cd.get(a.anchor),g=this.za.yg(b);if(!g)return a;var h=void 0;4==g.type&&(g.ha()&&(h=b.querySelector("figcaption")),h||(h=b));if(!h){for(var g=a.startIndex+1,b=[b],h=0,
k=null;0<b.length&&h<g;)if(k=b.pop(),!(k.nodeName in z.bT))if(3==k.nodeType)var n=k.nodeValue.replace(/(\r\n|\r|\n)/g,"").replace(/ +/g," "),h=h+n.length;else if(k.nodeName in z.cT)h+=z.cT[k.nodeName].length;else for(n=k.childNodes.length-1;0<=n;n--)b.push(k.childNodes[n]);h=k}g=z.ju(h,!0);a.offsetTop=Math.round(g.top+c.top);return a},a)},Zwa=function(a,b,c){b=z.B;var d='\x3cdiv class\x3d"paragraphControls js-paragraphControl js-paragraphControl-'+z.G(a.Gr)+' u-noUserSelect"\x3e',e=z.B,g;if(a.Dfa||
a.iga){g='\x3cdiv class\x3d"notesMarker u-noUserSelect" data-action\x3d"select-anchor" data-action-value\x3d"'+z.G(a.Gr)+'"\x3e';var h;h={};h=(0,z.B)(z.rx(z.D(h,{name:"asteriskFilled",size:"19px",content:(0,z.M)('\x3csvg class\x3d"svgIcon-use" width\x3d"19" height\x3d"19" viewBox\x3d"0 0 19 19" \x3e\x3cpath d\x3d"M14.78 8.07a8.681 8.681 0 0 0-.427-1.383.478.478 0 0 0-.584-.27l-3.12.77V4.034c0-.247-.19-.48-.43-.5a7.23 7.23 0 0 0-1.38 0c-.24.02-.43.253-.43.5V7.19L5.3 6.415a.48.48 0 0 0-.583.27c-.18.448-.324.91-.426 1.383-.05.24.1.5.32.58l3.06.754-1.98 2.956c-.14.196-.13.502.04.67.34.332.7.632 1.09.896.2.136.49.077.63-.117l2.09-3.114 2.09 3.112c.15.193.43.252.63.116.39-.26.75-.56 1.09-.89.17-.17.19-.47.04-.67L11.4 9.41l3.06-.76a.517.517 0 0 0 .32-.58" fill-rule\x3d"evenodd"/\x3e\x3c/svg\x3e')})));
g=g+z.C(h)+"\x3c/div\x3e"}else g="";var k;h=""+(1==a.Gs?"a note":"notes");h=z.E(h);k=""+(1==a.eY&&(0<a.Gs||a.Ms||a.Os)?0<a.Gs&&a.Ms&&a.Os?" highlighted, responded, and left "+h:0<a.Gs&&a.Os?" responded and left "+h:0<a.Gs&&a.Ms?" highlighted and left "+h:a.Ms&&a.Os?" highlighted and responded":a.Ms?" highlighted":0<a.Gs?" left "+h:a.Os?" responded":"":"");k=z.E(k);h='\x3cspan class\x3d"paragraphControls-itemText"\x3e';c=""+(0<a.xZ&&0==a.Efa&&!a.Ms&&!a.Os?1==a.xZ?"Note to self":"Notes to self":z.F(z.aS(z.D(a,
{social:a.Pda,isActive:0<a.Gs||a.Ms||a.Os,hg:a.eY,RN:!0,Mfa:!0,yW:0<a.Fw?"Top highlight":""}),c))+z.C(k));c=(0,z.M)(c);h+=z.F(z.hR(z.D(a,{text:c})))+"\x3c/span\x3e";a=(0,z.B)(h);a=e(g+a);return b(d+a+"\x3c/div\x3e")},X$=function(a,b,c){z.R.call(this);this.X=a;this.U3=a.get("floating-components");this.xa=a.get("screen");this.Sa=a.get("screen-service");this.li=a.get("uri-fragment");this.Za=a.get("dom-monitor");this.za=b;this.Mc=b.Mc;this.Df=this.Mc.querySelector(".js-postField");var d=z.sT("div","layoutSingleColumn notesPositionContainer");
z.qT(this.Mc,d,0);this.ST=d;this.Yc=a.get("quotes-data");this.Od=a.get("notes-data");this.Od.subscribe("new_note_list",this.w7,this);this.Rg=a.get("responses-data");this.Ti=null;this.Cd=new Bwa(this.Mc.querySelector(".js-notesSource"));this.Rx=this.Gf=this.zD=null;this.Gf=new V$(a,b,this.Cd,this.ST);this.track(this.Gf);this.Rx=this.Gf.U();this.Ui=this.zJ=null;this.Ed=c},Z$=function(a,b){if(a.isActive()){var c=(b=b||a.zJ)&&b.tF,d=b&&b.noteId;c&&(a.pr(c),d&&a.Od.Fl(d,c)&&a.Ui&&z.q(a.Ui,function(){Y$(this,
c,null,d)},a));Iva(a.li)}else a.zJ=b||null},Y$=function(a,b,c,d,e,g){var h={dh:!0,LN:767>=window.innerWidth};a.zK();c=new R$(a.X,a.za,b,d||"",c||null,a.Cd,e||null,g||null);c.subscribe("set-active-highlight",a.DU,a);c.subscribe("reset-highlight",a.Y9,a);c.subscribe("close",a.zK,a);b=g&&g.wa?g.wa:a.Cd.get(b);g=z.DK(a.U3);g.ak=b;b=g.pq(c);b.My=h;h=b.VG(a.Wj.bind(a));h.sD=!0;a.Ti=h.W()},$wa=function(a,b,c){var d=a.za.yg(M$(a.Cd,b));if(d&&4!=d.type){z.Pn(d,4);if(c){if(!awa(c,d))return;z.Nn(d,z.Tn(c.startIndex,
c.endIndex,c.id))}c={mode:a.za.ad()?"edit":"view",ah:z.Fp(a.za.Wa()),media:null,Ji:null,sections:!0,Hi:!1,pi:!1,vf:!1};a.Cd.get(b).innerHTML=z.Hq(d,z.v,c)}},axa=function(a,b){var c=z.eh();if(!c||c.isCollapsed())if(b&&(c=b),!c||c.isCollapsed())return null;var d=z.dg(c),e=Dwa(a.Cd,d);if(!e)return null;e=(d=z.Kt(d,z.RC,e))&&a.za.yg(d);if(!d)return null;var g=z.mu(c,d,!0),h=z.mu(c,d,!1);return-1==g||-1==h?null:new bwa(c,d,new z.Uq({anchor:d.getAttribute("name"),startIndex:g,endIndex:h,content:e.ha().substring(g,
h)}))},bxa=function(){},cxa=function(a,b,c){a=a||{};b=z.B;var d='\x3cdiv class\x3d"container u-maxWidth740"\x3e\x3cdiv class\x3d"responsesStreamWrapper u-maxWidth640 u-hide js-responsesStreamWrapper"\x3e\x3cdiv class\x3d"container u-maxWidth640 responsesStream-title"\x3e\x3cdiv class\x3d"row"\x3e\x3cdiv class\x3d"col u-size12of12"\x3e'+z.F(z.Gy({title:"Responses",sn:!0},c))+"\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e";if(c.supportsEdit){var e=a;a=z.B;c.isAuthenticated?e=z.F(z.l_({aq:(0,z.M)(""+(e.post.virtuals.responsesCreatedCount?
z.F(z.ET()):z.F(z.DT())))},c)):(e=e||{},e=(0,z.B)('\x3cdiv class\x3d"responses-loggedOutPrompt js-responsesLoggedOutPrompt"\x3e'+z.F(z.zw({icon:(0,z.M)(""+z.F(z.iy())),ca:!0,Wb:!0,Rd:(0,z.L)(""+z.H(z.No(z.D(e,{oG:!0}),0,c))),text:(0,z.M)(""+z.F(z.ET())),C:"button--loggedOutPrompt",source:"logged_out_response_prompt"},c))+"\x3c/div\x3e"));a='\x3cdiv class\x3d"container u-maxWidth640 responsesStream-editor cardChromeless"\x3e\x3cdiv class\x3d"row"\x3e\x3cdiv class\x3d"col u-size12of12"\x3e'+a(e)+"\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e"}else a=
"";return b(d+a+'\x3cdiv class\x3d"responsesStream js-responsesStream"\x3e\x3c/div\x3e\x3cdiv class\x3d"container u-maxWidth640 u-hide js-showOtherResponses"\x3e\x3cdiv class\x3d"row"\x3e'+z.F(z.vw({action:"show-other-responses",D:(0,z.M)(""+z.F((0,z.B)("Show all responses"))),isPrimary:!0,C:"responsesStream-showOtherResponses cardChromeless u-sizeFullWidth"},c))+'\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"responsesStream js-responsesStreamOther"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e')},$$=function(a){z.R.call(this);
this.Ba=a.get("screen-request");this.ea=null;this.EL=a.get("screen-view-state");this.X=a;this.VK=!1;this.$J=this.nd=null},dxa=function(a){this.X=a;this.Ba=a.get("screen-request");this.bo={footerGrid:4,metabar:1,sideCard:3,topCard:1,bottomCard:1,footerGridWithPromotion:3}};z.m(k$,z.A);z.f=k$.prototype;z.f.H=function(){return""};z.f.L=function(){return"Placement"};z.f.El=function(){return z.x(this,"items")};z.f.v_=function(a){return z.y(this,"location",a)};z.f.Dc=z.l(301);
z.f.sb=function(a){return z.y(this,"index",a)};z.f.N=function(){return k$.prototype};
z.f.F={name:"Placement",fields:{items:{name:"items",g:function(){return z.ZO},Z:z.X,h:function(){return 1},j:function(){return"gen.model.StreamItem"},defaultValue:function(){}},location:{name:"location",g:function(){return z.hN},h:function(){return 2},j:function(){return"gen.model.PlacementLocation"},defaultValue:function(){}},index:{name:"index",g:function(){return Number},h:function(){return 3},j:function(){return"int32"},defaultValue:function(){}}},O:{}};
z.f.Dc=z.Y(301,function(){return z.x(this,"index")});z.da(m$,z.bi);m$.prototype.Hh=function(a){var b={};z.AJ(this,b,a.Cb(),"");return b};
m$.prototype.jb=function(a,b){if(!a||!b)return null;var c=new a;Object.keys(b).forEach(function(a){for(var e=a.split(/[\[\]]+/).filter(function(a){return!!a}),g=c,h=void 0;h=e.shift();){var k=g.F.hk[h];if(!k)break;var n=k.g();if(k.Z()){var p=z.Gi(g,h)||[],u=e.shift(),w=Number(u);if(void 0===u||!Number.isInteger(w)||0>w)break;if(n.prototype instanceof z.ui)k=p[w],k||(k=new n,p[w]=k),z.y(g,h,p),g=k;else{if(void 0!==e.shift())break;n=Bva(b[a],k);p[w]=n;z.y(g,h,p)}}else if(n.prototype instanceof z.ui)p=
z.Gi(g,h),p||(p=new n,z.y(g,h,p)),g=p;else{if(void 0!==e.shift())break;n=Bva(b[a],k);z.y(g,h,n)}}});return c};z.m(n$,z.A);z.f=n$.prototype;z.f.H=function(){return""};z.f.L=function(){return""};z.f.iF=z.l(442);z.f.N=function(){return n$.prototype};z.f.F={name:"PlacementsResponse",fields:{placements:{name:"placements",g:function(){return k$},Z:z.X,h:function(){return 1},j:function(){return"gen.model.Placement"},defaultValue:function(){}}},O:{}};z.m(o$,z.A);o$.prototype.H=function(){return""};
o$.prototype.L=function(){return""};o$.prototype.N=function(){return o$.prototype};o$.prototype.F={name:"PlacementsRequestQuery",fields:{requestContext:{name:"requestContext",g:function(){return z.LH},h:function(){return 1},j:function(){return"PlacementsRequestContext"},defaultValue:function(){}},slots:{name:"slots",g:function(){return z.MH},Z:z.X,h:function(){return 2},j:function(){return"PlacementSlot"},defaultValue:function(){}}},O:{}};
z.sZ.prototype.vG=z.Y(454,function(a){a!=this.sC&&this.Qa&&(this.Qa.Bf.contentEditable=a);this.sC=a});z.ZJ.prototype.$M=z.Y(446,function(a){a=q$(a);if(!a)return null;a=r$(a)&&r$(a).nk();return a?(a=a.Bb())&&a.length?a[0].getName():null:null});n$.prototype.iF=z.Y(442,function(){return z.x(this,"placements")});
z.BJ.prototype.iF=z.Y(441,function(a,b){var c=this,d=Dva(Eva(new o$,a),b),d=(new m$).Hh(d),e=this.l.w(z.cla,{},d);return z.CJ(this,e,function(){return z.q(c.S.get(e,{background:!0}),function(a){a=c.la.hb(n$,a);c.ba.ob(a);return a})})});z.qE.prototype.VG=z.Y(422,function(a){this.Wj=a;return this});z.CK.prototype.VG=z.Y(421,function(a){this.Wj=a;return this});z.rv.prototype.Fl=z.Y(329,function(){return z.x(this,"note")});z.wJ.prototype.Fl=z.Y(328,function(a){return this.ab("Note",a)});
z.Sq.prototype.gs=z.Y(327,function(){return z.x(this,"replyId")});z.rv.prototype.gs=z.Y(326,function(){return z.x(this,"replyId")});z.Qq.prototype.Us=z.Y(325,function(a){return z.y(this,"highlight",a)});z.Qq.prototype.ZE=z.Y(324,function(){return z.x(this,"highlight")});z.Qq.prototype.cm=z.Y(323,function(a){return z.y(this,"author",a)});z.Sq.prototype.cm=z.Y(322,function(a){return z.y(this,"author",a)});z.Cv.prototype.cm=z.Y(321,function(a){return z.y(this,"author",a)});
z.Qq.prototype.Ur=z.Y(320,function(){return z.x(this,"author")});z.Sq.prototype.Ur=z.Y(319,function(){return z.x(this,"author")});z.Cv.prototype.Ur=z.Y(318,function(){return z.x(this,"author")});z.Qq.prototype.Av=z.Y(317,function(){return z.x(this,"highlightId")});z.Qq.prototype.vw=z.Y(316,function(a){return z.y(this,"authorId",a)});z.Sq.prototype.vw=z.Y(315,function(a){return z.y(this,"authorId",a)});z.Qq.prototype.Zs=z.Y(314,function(a){return z.y(this,"state",a)});
z.Sq.prototype.Zs=z.Y(313,function(a){return z.y(this,"state",a)});z.uv.prototype.Zs=z.Y(312,function(a){return z.y(this,"state",a)});z.Qq.prototype.Re=z.Y(311,function(){return z.x(this,"noteId")});z.Sq.prototype.Re=z.Y(310,function(){return z.x(this,"noteId")});z.rv.prototype.Re=z.Y(309,function(){return z.x(this,"noteId")});z.yk.prototype.CA=z.Y(242,function(a){return z.y(this,"inResponseToPostId",a)});z.o_.prototype.CA=z.Y(241,function(a){this.Gx=a;return this});
z.qj.prototype.jF=z.Y(179,function(){return z.x(this,"point")});v$.prototype.jF=function(){var a=window.document.body;return z.Hf(a,this.Vf.node)?this.Vf:this.Zh&&z.Hf(a,this.Zh)?z.nu(this.PC,this.Zh):this.ld&&(a=z.Ot(this.R3,this.ld))?z.nu(this.PC,a):null};z.da(x$,z.R);x$.prototype.V=function(){z.R.prototype.V.call(this);z.O(this.U(),u$,{post:this.ea,Ega:!0,Ew:this.Caa,Vea:this.ex,ca:this.ex,Sea:this.ex,Rea:this.CU,bA:!this.ex})};z.da(y$,z.R);z.f=y$.prototype;
z.f.V=function(){z.R.prototype.V.call(this);this.Ze();this.rD();z.U(this.U()).o("sidecard-dismiss",this.t3,this)};z.f.ga=function(){z.Xv(this.U());z.R.prototype.ga.call(this)};z.f.fx=function(a){var b=window.document.createElement("div");b.className="cardChromeless u-width200 u-hide u-md-hide";a.appendChild(b);return b};z.f.Ze=function(){z.O(this.U(),Ova,{posts:this.hD})};
z.f.rD=function(){if(z.Uk(z.v).enable_related_reads_side_card_fixed){var a=this.U();z.t(a,"u-positionFixed");z.t(a,"u-transition--fadeOut300");if(this.Wo)a.style.top=this.Wo;else{var b=(z.iu().height-250)/2,b=Math.max(b,0);this.Wo=b+"px";a.style.top=this.Wo;1300<this.wB&&(z.Wt(a),this.qT(),z.Zu(this,this.rc,"refresh",this.qT,this))}}else if(a=this.U(),z.t(a,"u-positionAbsolute"),this.Wo)a.style.top=this.Wo;else{var c=z.iu().height,b=z.cu(this.za.Df).y,c=Math.max(1.5*c,b+c+650);a:{var d;if((d=this.za.Df.querySelectorAll(".graf--p"))&&
d.length){var e=d[0];if(e){for(var g=z.cu(e).y,h=z.ju(e).height,k={y:g,height:h},n=[],p=1;p<d.length;p++)e=d[p],g=z.cu(e).y,h=z.ju(e).height,e.classList.contains("graf-after--p")?k=k?{y:k.y,height:g-k.y+h}:{y:g,height:h}:(n.push({y:k.y,height:k.height}),k={y:g,height:h});n.push(k);d=n}else d=[]}else d=[];if(d&&d.length)for(e=0;e<d.length;e++)if(!(250>d[e].height||c>d[e].y+d[e].height)&&(c=Math.max(c,d[e].y),c>=d[e].y&&c+250<=d[e].y+d[e].height))break a;c=-1}650>c||(this.Wo=c+"px",a.style.top=this.Wo,
650<b+this.wB-c&&(z.Wt(a),a={userId:z.Pk().userId,experimentName:"recirculation.experimentSideCard",action:"side_card_shown",article_ratio:c/this.wB},z.T(z.bN,a)))}};
z.f.qT=function(){var a=this.U();if(a&&!this.tS){var b=z.iD(this.rc,this.za.Df),c;c=Math.max(.25,650/this.wB);var d=z.Lc(a,"u-transition--fadeIn300");b>=c&&.95>=b&&!d?(z.Tc(a,"u-transition--fadeOut300","u-transition--fadeIn300"),a={userId:z.Pk().userId,experimentName:"recirculation.experimentSideCard",action:"side_card_shown",article_ratio:b},z.T(z.bN,a)):d&&(b<c||.95<b)&&(z.Tc(a,"u-transition--fadeIn300","u-transition--fadeOut300"),a={userId:z.Pk().userId,experimentName:"recirculation.experimentSideCard",
action:"side_card_hidden",article_ratio:b},z.T(z.bN,a))}};z.f.t3=function(){this.tS=!0;z.Tc(this.U(),"u-transition--fadeIn300","u-transition--fadeOut300");var a={userId:z.Pk().userId,experimentName:"recirculation.experimentSideCard",action:"side_card_dismissed"};z.T(z.bN,a)};z.m(z$,z.$f);z$.prototype.sA=function(){if(!this.wh)return null;var a=this.wh.jF();if(!a)return null;var b=this.Xi.jF();return b?z.Rg(a.node,a.offset,b.node,b.offset):null};z.da(A$,z.R);A$.prototype.yga=function(a){this.$q=a};
A$.prototype.zga=function(a){this.za=a;this.ea=this.za.Wa()};
A$.prototype.V=function(){if(this.U()){z.R.prototype.V.call(this);var a=this.$q.metabar;if(z.Uk(z.v).enable_read_next_in_metabar&&a&&a.length){var b=z.dF(a),c=this.xa.query(".js-readNextMetabarRight");c&&(b=new x$(b,"read_next_metabar_promo"),b.ex=!0,b.CU=!0,b.Ha(c),this.track(b),z.T(z.JH,{promoId:"post_page_read_next_metabar_popup"}),(c=this.xa.query(".js-postActionRightSeparator"))&&z.Oc(c,"u-invisible"))}c=this.$q.topCard;if(z.Uk(z.v).enable_related_reads_header_promo&&c&&c.length){var b=z.dF(c),
d=this.xa.query(".js-readNextHeaderCard");d&&(this.track((new x$(b,"read_next_header_promo")).Ha(d)),z.t(d,"is-visible"),z.T(z.JH,{promoId:"post_page_read_next_header_popup"}))}b=this.$q.bottomCard;if((z.Uk(z.v).enable_related_reads_footer_promo||z.Uk(z.v).enable_related_reads_footer_promo_always_shown)&&b&&b.length){var d=z.dF(b),e=this.xa.query(".js-readNextFooterCard");e&&this.track((new x$(d,"read_next_footer_promo")).Ha(e))}d=this.$q.sideCard;(z.Uk(z.v).enable_related_reads_side_card||z.Uk(z.v).enable_related_reads_side_card_fixed)&&
d&&d.length&&(e=new y$(this.X,this.xa.U(),d,this.za),this.track(e));var e=this.$q.footerGrid,g=this.$q.postPromotion;!z.Uk(z.v).enable_related_reads_footer_grid_ui||z.Uk(z.v).enable_placements||!e||!e.length||(g?z.O(this.U(),Sva,{posts:e,postPromotion:g}):z.O(this.U(),Tva,{posts:e}));a=z.Qa(a,d,c,b);z.Uk(z.v).enable_read_next_mobile_carousel&&(c=this.xa.query(".js-relatedReadsMobileCarousel"))&&(a&&a.length?z.O(c,Rva,{posts:a,source:"related_reads_mobile_carousel"}):z.Qt(c))}else z.Q("Attempted to initialize RelatedReadsRecirculationControl without root element.")};
A$.prototype.ga=function(){z.R.prototype.ga.call(this);this.Aa&&(this.Aa.cancel(),this.Aa=null)};z.m(B$,z.R);z.f=B$.prototype;z.f.Jh=function(){return this.al.Jh()};
z.f.V=function(){B$.R.V.call(this);z.Zu(this,this.GI,"data-redirect-type-quote",this.K6,this);this.pa(this.Mc,"click",this.zx,this);z.rH(this.za)&&z.qt()&&this.pa(this.Mc,"mouseover",this.C4,this);this.za.Wa().Bp()&&!this.za.ad()&&z.r(this.Yc.load(this.za.ua()),z.Q);var a=this.Jh();a&&(z.Zu(this,a,"quote",this.x4,this),z.Zu(this,a,"quote-respond",this.y4,this),z.Zu(this,a,"show",this.uL,this),z.Zu(this,a,"hide",this.g7,this))};
z.f.K6=function(a){var b=z.lG(this.al,this.Jh().kl);b&&(a.url=new z.cd(this.l.w(z.yM,{postId:this.za.ua()},{paragraphs:JSON.stringify([b.ns.jb().Cb()]),startOffset:b.start,endOffset:b.end})))};z.f.zx=function(a){z.Kt(a.target,function(a){if(a===this.Mc)return!0;var c=z.YC(a);if(3==c)return!0;if(7==c){if(c=Yva(this,a))if(C$(this,c),z.qt())E$(this,c);else{var d=new z.aE;Wva(this,c,a,d)}return!0}return!1}.bind(this))};
z.f.C4=function(a){z.Kt(a.target,function(a){if(a===this.Mc)return!0;var c=z.YC(a);if(3==c)return!0;if(7==c){c=z.eh();if(!(c&&!c.isCollapsed()||this.Jh()&&this.Jh().Fi())&&(c=Yva(this,a))){var d=this.Mc.querySelector('.markup--quote[name~\x3d"'+c.zg()+'"]');a=new z.cE(a,100);Wva(this,c,d,a);C$(this,c)}return!0}return!1}.bind(this))};
z.f.uL=function(){var a=z.eh();a&&!a.isCollapsed()&&C$(this,null);z.rH(this.za)&&(a=z.lG(this.al,this.Jh().kl))&&(a=z.YF(this.Yc,a.ns,a.start,a.end),z.Rc(this.Jh().oa().querySelector(".js-highlightMenuQuoteButton"),"is-active",!!a))};z.f.g7=function(){this.Im&&C$(this,null)};
z.f.x4=function(){if(z.rH(this.za)){var a=z.fG(this.Jh());if(a){var b=a.range,c=a.Nea,d=z.Lc(this.Jh().oa().querySelector(".js-highlightMenuQuoteButton"),"is-active"),a=z.lG(this.al,b);z.r(z.q(this.Yc.toggle(a.ns,a.start,a.end,!c),function(a){z.$S();d?z.hG(this.Jh()):E$(this,a);var b=c?"selection_menu":"quote_click_menu";F$(this,a.zg(),!d,b)},this),z.Q)}}};
z.f.y4=function(){if(z.rH(this.za)&&z.v.supportsEdit){var a=z.fG(this.Jh());if(a){var b=z.lG(this.al,a.range);z.r(z.q(this.Yc.create(b.ns,b.start,b.end,1,!0),function(a){F$(this,a.zg(),!0,"selection_menu_quote_respond");this.aa("quote-respond",a,b.ns.name)},this),z.Q)}}};
z.f.K4=function(a){var b=this.Im,c=D$(this,b),d=b.nc(),e=b.$c(),b=a.query(".js-quoteAttributions-pileOn"),g=z.Lc(b,"is-active");z.r(z.q(this.Yc.toggle(c,d,e,!0),function(b){var k=a.query(".js-quoteAttributions-pileOn");z.Sc(k,"is-active");if(k=z.ZF(this.Yc,c,d,e)){var n=Vva(this,k),p=a.query(".js-quoteAttributions-info");z.O(p,Nva,n)}else a.Mb();!g&&z.qt()&&(a.Mb(),E$(this,k));k=z.qt()?"quote_hover":"quote_click_mobile";F$(this,b.zg(),!g,k)},this),z.Q)};
z.f.L4=function(){if(z.rH(this.za)&&z.v.supportsEdit){var a=D$(this,this.Im),b=this.Im.nc(),c=this.Im.$c();z.r(z.q(this.Yc.create(a,b,c,1,!0),function(b){F$(this,b.zg(),!0,"quote_respond");this.aa("quote-respond",b,a.name)},this),z.Q)}};
z.f.tU=function(){var a=new z$(this.Mc),b=this.Yc.Lo,c=Object.keys(b).concat(this.zR);z.Wa(c);c.forEach(function(a){var c=b[a]||[],g=this.za;if(g=(a=g.Mc&&z.Ot(g.Mc,a))&&this.za.yg(a))Mva(g,c),a.innerHTML=z.Hq(g,z.v,z.oH(this.za)),z.SK(this.o9,a)},this);this.zR=Object.keys(b);(a=a.restore())&&a.select()};z.m(G$,z.Wu);z.f=G$.prototype;z.f.load=function(a){if(!z.Rk())return z.Fc([]);this.Ca=a;this.Pk||(this.Pk=z.r(z.q(this.dl.get(this.l.w(z.bka,{postId:a}),{background:!0}),this.m9,this),z.Q));return this.Pk.dc()};
z.f.Rl=function(){return this.xR};z.f.Gv=function(){return this.YT};z.f.ZE=function(a){return this.AS[a]||null};z.f.Fl=function(a,b){return z.JQ(H$(this,b),a)};z.f.Us=function(a,b){this.AS[a]=b};z.f.ua=function(){return this.Ca};
z.f.m9=function(a){var b=a.references.User;this.YT=a.post.visibility;var c=a.value;if(c)for(var d=0;d<c.length;d++){var e=c[d];if("HIDDEN"!=e.state){var g=e.replies,h=b;if(g)for(var k=0;k<g.length;k++){var n=g[k],p=n.authorId||null;n.author=p&&h[p]||null}g=e.anchor;h=e.authorId||null;e.author=h&&b[h]||null;g=H$(this,g);e=z.Rq(e);g.add(z.AF(this.ba,e))}}if(a=a.highlights)for(b=0;b<a.length;b++)this.Us(a[b].id,z.Ri.jb(z.Uq,a[b]));this.xR=!0};z.da(K$,z.R);K$.prototype.V=function(){var a=this;z.R.prototype.V.call(this);z.q(this.Ba.iF(this.R9,this.f9),function(b){b.placements&&b.placements.forEach(a.n5,a)})};K$.prototype.n5=function(a){switch(a.location){case z.NH:var b=this.xa.query(".js-postFooterPlacements");z.O(b,z.DS,{items:a.items,context:2})}};z.da(L$,z.R);L$.prototype.se=function(a){this.ea=a};L$.prototype.V=function(){var a=this;this.U()?(z.R.prototype.V.call(this),z.r(z.q(Hva(this.Ba,this.ea.Ia()),function(b){z.O(a.U(),Uva,{items:z.WF(b.Qf),context:9});var c=a.query(".js-relatedReadsStream");b=new z.IU(a.X,b.Qf);b.Ha(c);b.Hg(9);a.track(b)}),z.Q)):z.Q("Attempted to initialize RelatedReadsStreamControl without root element.")};cwa.prototype.xE=function(a,b,c){return new B$(a,b,c)};Bwa.prototype.get=function(a){return M$(this,a)};z.m(N$,z.sZ);z.f=N$.prototype;z.f.By=!1;z.f.fu="";z.f.Cy=0;z.f.Tl=z.X;z.f.Re=function(){return this.MJ};z.f.save=function(){this.Ea().length<=this.dj&&this.nr()};z.f.La=function(){(0,window.clearTimeout)(this.Cy);N$.R.La.call(this)};z.f.V=function(){function a(a){a.stopPropagation()}N$.R.V.call(this);this.fu=this.Ea();this.cd(this.fu);this.Fr(13,this.PJ,this);this.Fr(27,this.QJ,this);this.Qa.pa("blur",this.OJ,!1,this);var b=this.Qa.oa();z.Yt(b,"keydown",a);z.Yt(b,"keyup",a);z.Yt(b,"keypress",a)};
z.f.OO=function(a){return a};z.f.nr=function(){if(this.isEnabled()){var a=this.Ea().trim();if(a){this.vG(!1);var b=this.wX(),a=this.vX(a);this.aa("saving",a);z.wc(z.r(z.q(this.dl.post(b,a.Cb()),this.A7,this),this.y7.bind(this,a)),this.vG.bind(this,!0))}}};z.f.A7=function(a){this.aa("save",this.OO(a.value))};z.f.y7=function(a,b){this.aa("fail",a);this.ia.error((0,z.B)("Saving failed. You may be having connectivity issues or notes might be disabled on this post. Please try again."));z.Q(b)};
z.f.PJ=function(a){if(this.Ar&&this.Ar.Ul())return!1;a.shiftKey||(a.preventDefault(),this.save());return!0};z.f.QJ=function(a){if(this.Ar&&this.Ar.Ul())return!1;a.preventDefault();this.cd(this.fu);this.aa("cancel");return!1};z.f.OJ=function(){this.By&&(this.Ea().length>=this.dj?(0,window.confirm)(this.zX())?(this.cd(this.fu),this.aa("cancel")):this.focus():this.Cy=(0,window.setTimeout)(this.nr.bind(this),100))};z.m(O$,N$);z.f=O$.prototype;z.f.uH=null;z.f.ZQ=null;z.f.vH=null;z.f.ph=null;z.f.YI=null;z.f.XI=null;z.f.zS=null;z.f.Us=function(a){this.ph=a;this.YI=a.startIndex;this.XI=a.endIndex;this.zS=a.content;return this};z.f.zX=function(){return(0,z.B)("Your note is too long; do you want to abandon your changes?")};z.f.OO=function(a){var b=z.lt();a=z.Rq(a).cm(b).vw(b.Ra());this.ph&&a.Av()&&this.Od.Us(a.Av(),this.ph);var b=this.Od,c;c=z.AF(b.ba,a);H$(b,c.Kc()).add(c);return a};
z.f.wX=function(){return this.Re()?this.l.w(z.cka,{postId:this.Ca,noteId:this.Re()}):this.l.w(z.aka,{postId:this.Ca})};z.f.vX=function(a){var b=z.lt();a=(new z.Qq({content:a,anchor:this.uH,anchorContent:this.ZQ,anchorImage:this.vH?this.vH.Cb():null,replies:[],createdAt:Date.now()})).cm(b);null!=this.YI&&null!=this.XI&&(b=new z.Uq({anchor:this.uH,startIndex:this.YI,endIndex:this.XI,content:this.zS}),a.Us(b));return a};z.m(P$,N$);P$.prototype.zX=function(){return(0,z.B)("Your reply is too long; do you want to abandon your changes?")};P$.prototype.OO=function(a){var b=z.lt();a=z.Tq(a).cm(b).vw(b.Ra());t$(this.Od.Fl(a.Re(),this.ld)).push(a);return a};P$.prototype.wX=function(){return this.pU?this.l.w(z.fka,{postId:this.Ca,noteId:this.Re(),replyId:this.pU}):this.l.w(z.eka,{postId:this.Ca,noteId:this.Re()})};
P$.prototype.vX=function(a){var b=z.lt();return(new z.Sq({replyId:"",postId:this.Ca,noteId:this.Re(),content:a,createdAt:Date.now()})).cm(b)};z.m(R$,z.R);z.f=R$.prototype;
z.f.V=function(){R$.R.V.call(this);z.U(this.U()).o("show-note-editor",this.WK,this).o("hide-note-editor",this.UI.bind(this,!0)).o("show-reply-editor",this.paa,this).o("hide-reply-editor",this.e5,this).o("save-note",this.l$,this).o("save-reply",this.n$,this).o("highlight-quote",this.h5,this).o("dismiss-note",this.DR.bind(this,!0),this).o("delete-note",this.DR.bind(this,!1),this).o("delete-reply",this.m3,this).o("previous-highlight-tip",this.k9,this).o("next-highlight-tip",this.m6,this);Kwa(this);this.Rg&&
l$(this.Rg)&&(Jwa(this),z.Zu(this,l$(this.Rg),"add",this.x7,this));if(this.rK&&this.LS&&this.MS){var a=this.query(".js-inlineNewPostControl"),b=this.rK,c=this.za.ua(),d=new z.o_(this.X);d.yA("web-inline-quote-responses");d.Ha(a);d.kx=!0;d.eI=!0;d.cI=!0;d.OD=Pva;d.Qq=b;d.CA(c);d.Gy=!0;this.nd=d;this.nd.W();a=T$(this.ry);this.aa("set-active-highlight",this.ld,a)}this.ph&&(this.WK(),this.he&&this.he.focus());U$(this,0)};
z.f.ga=function(){this.vm&&this.vm.AM();(this.ph||this.ry)&&this.aa("reset-highlight",this.ld,null);R$.R.ga.call(this)};z.f.La=function(){z.Xv(this.U());z.Bf(this.U());z.qd(this.nd);z.qd(this.he);z.qd(this.vm);z.rd(z.eb(this.uh));this.vm=this.uh=this.he=this.nd=null;R$.R.La.call(this)};z.f.kn=function(){if(this.he&&this.he.Ea())return!0;for(var a=z.eb(this.uh),b=0;b<a.length;b++)if(a[b]&&a[b].Ea())return!0;return this.nd&&!this.nd.isDismissable()?!0:!1};
z.f.fx=function(){var a=[],b=[],c=[],d=this.ju&&(this.ph||this.ry);d||(this.Uq?(a=this.Yc?p$(this.Yc,this.Uq.quotes):[],b=this.Uq.notes,c=this.Uq.responses):(b=this.Od?z.WF(H$(this.Od,this.ld)):[],this.MJ||(this.Yc?(a=this.Yc,a=p$(a,a.Lo[this.ld]||[])):a=[],c=this.Rg?s$(this.Rg,this.ld):[])));return z.nt(Gwa,{post:this.za.Wa(),quotes:a,notes:b,responses:c,gQ:!!this.rK,BG:d,KA:this.ju,Fw:this.iV,Ffa:z.qH(this.za)})};
z.f.x7=function(){var a=this.query(".js-blockGroupPosts"),b=z.nt(Fwa,{responses:s$(this.Rg,this.ld)});z.Cf(b,a);Jwa(this)};
z.f.WK=function(){if(this.ju){if(!this.he){var a=this.query(".js-noteEditor"),b=String(z.mt(Ewa)),a=this.he=new O$(this.X,a,this.za.ua(),null,b),b=this.ld,c=this.za.yg(this.Cd.get(this.ld)),d=c.ha(),c=4==c.type?c.zd():null;a.uH=b;a.ZQ=d;a.vH=c;(a=this.ph)&&this.he.Us(a);z.Zu(this,this.he,"saving",this.a8,this);z.Zu(this,this.he,"fail",this.e7,this);z.Zu(this,this.he,"save",this.V7,this)}z.t(this.query(".js-noteActions"),"is-noteEditorVisible");this.he&&this.he.focus()}};
z.f.l$=function(){this.he&&this.he.save()};z.f.a8=function(a){this.he.cd("");var b=this.query(".js-notesList");a={note:a,post:this.za.Wa(),BG:this.ju,KA:this.ju};a=z.nt(Q$,a);b.appendChild(a);z.Oc(b,"is-empty");Kwa(this);this.UI()};z.f.V7=function(a){var b=this.query(".js-notesList").lastChild;a=a.Re();z.t(b,"js-note-"+a);b.setAttribute("data-note-id",a);(b=b.querySelector(".js-deleteNote"))&&b.setAttribute("data-action-value",a)};
z.f.e7=function(){var a=this.query(".js-notesList");a.removeChild(a.lastChild);z.t(a,"is-empty");this.WK()};z.f.UI=function(a){a?this.aa("close"):this.he&&(this.he.Ea()&&this.he.cd(""),z.Oc(this.query(".js-noteActions"),"is-noteEditorVisible"))};z.f.paa=function(a){(a=S$(a.target))&&this.ju&&Lwa(this,a)};z.f.n$=function(a){a=S$(a.target);(a=this.uh[a])&&a.save()};
z.f.b8=function(a){var b=a.Re();this.uh[b]&&this.uh[b].cd("");var c=this.Od.Fl(b,this.ld).author.userId==a.author.userId,d=this.query(".js-note-"+a.Re()+" .js-repliesList");a={note:a,post:this.za.Wa(),CY:c};a=z.nt(Q$,a);d.appendChild(a);z.Oc(d,"is-empty");Mwa(this,b)};z.f.W7=function(a){var b=this.query(".js-note-"+a.Re()).querySelector(".js-repliesList").lastChild;a=a.gs();z.t(b,"js-reply-"+a);(b=b.querySelector(".js-deleteNote"))&&b.setAttribute("data-action-value",a)};
z.f.f7=function(a){var b=this.query(".js-note-"+a.Re()+" .js-repliesList");b.removeChild(b.lastChild);z.t(b,"is-empty");Lwa(this,a.Re())};z.f.e5=function(a){(a=S$(a.target))&&Mwa(this,a)};z.f.h5=function(a){a=a.target;var b=a.getAttribute("data-quote-creator-id"),c=M$(this.Cd,this.ld);c&&(this.vm&&this.vm.AM(),this.vm=Owa(this,c,a,function(){Nwa(this,b,!1);z.qd(this.vm);this.vm=null}),Nwa(this,b,!0))};
z.f.g5=function(a){var b=M$(this.Cd,this.ld);(a=this.Od.Fl(a.target.getAttribute("data-note-id"),this.ld))&&b&&(b=(b=a.Av())?this.Od.ZE(b):null,this.aa("set-active-highlight",this.ld,b))};z.f.i5=function(a){var b=M$(this.Cd,this.ld),c;c=this.Rg;a=a.target.getAttribute("data-post-id");c=l$(c)?z.JQ(l$(c),a):null;b&&c&&(b=q$(c))&&(b=r$(b)&&r$(b).nk())&&(c=b.Bb())&&c.length&&(b=T$(b),this.aa("set-active-highlight",this.ld,b))};
z.f.tL=function(){var a=null;this.ry&&(a=T$(this.ry));this.ph&&(a=this.ph);this.aa("reset-highlight",this.ld,a)};
z.f.DR=function(a,b){var c=b.value,d=this.Od.Fl(c,this.ld),e=this.query(".js-note-"+c);if(d&&e){z.Qt(e);this.tL();this.ib(".js-note-item").every(function(a){return z.Lc(a,"u-hide")})&&this.UI(!0);var g=I$(this.Od,d,"HIDDEN");z.r(g.ri,function(b){this.fa.W(a?(0,z.B)("Yikes! Something happened and we couldn’t dismiss this note."):(0,z.B)("Yikes! Something happened and we couldn’t delete this note."),"error");g.tA();z.Wt(e);(400>b.status||499<b.status)&&I$(this.Od,d,"NEW")},this);z.q(this.fa.W(a?(0,z.B)("The note has been dismissed."):
(0,z.B)("The note has been deleted."),{type:"success",Gw:!0}),function(){this.fa.Mb();g.tA();I$(this.Od,d,"NEW");z.Wt(e)},this)}};
z.f.m3=function(a){var b=a.value,c=this.query(".js-reply-"+b),d=S$(a.target);if(d&&c){z.Qt(c);var e=J$(this.Od,b,d,this.za.ua(),this.ld,"HIDDEN");z.r(e.ri,function(){this.fa.W((0,z.B)("Yikes! Something happened and we couldn’t delete this reply."),"error");e.tA();z.Wt(c);J$(this.Od,b,d,this.za.ua(),this.ld,"")},this);z.q(this.fa.W((0,z.B)("The reply has been deleted."),{type:"success",Gw:!0}),function(){this.fa.Mb();e.tA();J$(this.Od,b,d,this.za.ua(),this.ld,"");z.Wt(c)},this)}};
z.f.k9=function(){U$(this,this.hC-1)};z.f.m6=function(){U$(this,this.hC+1)};z.m(V$,z.R);z.f=V$.prototype;z.f.V=function(){V$.R.V.call(this);var a=[];z.qH(this.za)&&a.push(this.Od.load(this.Ca));this.QS||(a.push(this.Yc.load(this.Ca)),a.push(this.Rg.load(this.Ca)));this.Hq=z.q(z.q(z.q(z.SD(a),function(){this.Hq=null},this),this.ow,this),this.w2,this);z.Zu(this,this.Za,"resize-end",this.Fe,this)};z.f.ga=function(){this.Hq&&this.Hq.cancel();V$.R.ga.call(this)};z.f.La=function(){this.Hq=null;V$.R.La.call(this)};z.f.ow=function(){Cwa(this.Cd,function(a,b){W$(this,b)},this)};
z.f.Fe=function(){Cwa(this.Cd,function(a,b){Vwa(this,b)},this)};z.f.w2=function(){var a=this.Yc.bl;z.Zu(this,a,"add",this.LT,this);z.Zu(this,a,"remove",this.LT,this);(a=l$(this.Rg))&&z.Zu(this,a,"add",this.S7,this)};z.f.LT=function(a){Pwa(this,Object.keys(z.bG(this.Yc,a instanceof Array?a:[a])))};z.f.S7=function(a){Pwa(this,(a instanceof Array?a:[a]).map(this.Rg.$M,this.Rg))};z.f.fx=function(a){var b=window.document.createElement("div");b.className="notesMarkers";a.appendChild(b);return b};
z.f.Tx=function(a,b){z.nb(a,{startIndex:Math.min(a.startIndex,b.startIndex),endIndex:Math.max(a.endIndex,b.endIndex),notes:a.notes.concat(b.notes),quotes:a.quotes.concat(b.quotes),responses:a.responses.concat(b.responses)})};z.m(X$,z.R);z.f=X$.prototype;
z.f.V=function(){X$.R.V.call(this);this.pa(this.xa.U(),"click",this.Q5,this,!0);z.U(this.Rx).o("select-anchor",this.c8,this);var a=this.za.Wa();if(a.Bp()&&!this.za.ad()){var b=z.zk(a),b=2==a.visibility&&b&&!z.Bj(b.Mh());a.allowResponses&&!b&&z.r(this.Rg.load(this.za.ua(),"best"),z.Q);a.Mh().RE()&&(this.NC=z.q(this.Od.load(this.za.ua()),this.B7,this));z.r(this.Yc.load(this.za.ua()),z.Q)}this.zJ&&Z$(this);z.Zu(this,this.Sa,"historyUpdate",function(){Z$(this,z.DH())},this);this.Ed&&z.Zu(this,this.Ed,
"highlight",this.z7,this)};z.f.La=function(){z.qd(this.Gf);this.Gf=null;z.qd(this.Ti);this.Ti=null;this.Rx&&z.U(this.Rx).clear("select-anchor");this.NC&&this.NC.cancel();this.NC=null;X$.R.La.call(this)};z.f.Jfa=function(a,b){Y$(this,b,null,null,a)};z.f.gha=function(){this.Gf&&this.Gf.Fe()};z.f.kn=function(){if(!this.Ti)return!1;var a=this.Ti.Ea();return a?a.kn():!1};z.f.w7=function(a){a.subscribe("add",this.qV,this);a.subscribe("remove",this.qV,this)};
z.f.qV=function(a){(z.ia(a)?a:[a]).forEach(function(a){W$(this.Gf,a.Kc())},this)};z.f.B7=function(){var a=(0,z.Ba)();this.NC=null;Z$(this,z.DH());this.pa(this.Df,z.DL,this.XJ,this);z.HA("notes.renderMarkers",(0,z.Ba)()-a)};z.f.XJ=function(a){(a=a.target.getAttribute("name"))&&M$(this.Cd,a)&&Vwa(this.Gf,a)};z.f.z7=function(){if(this.Ed){var a=axa(this,this.Ed.kl);z.hG(this.Ed);a&&(a=a.highlight,this.DU(a.anchor,a),Y$(this,a.anchor,a))}};
z.f.Q5=function(a){if(this.Ti){var b=a.target;if(!z.Hf(this.Ti.U(),b)){var c=this.Ti.Ea(),d;if(!(d=!c)){a:if(c.he&&c.he.Ea())c=!0;else{d=z.eb(c.uh);for(var e=0;e<d.length;e++)if(d[e]&&d[e].Ea()){c=!0;break a}c=c.nd&&!c.nd.Cg()?!0:!1}d=!c}d&&(c=this.Ti&&this.Ti.ak,d="select-anchor"==b.getAttribute("data-action"),this.zK(),c&&d&&z.Hf(c,b)&&a.stopPropagation())}}};
z.f.Wj=function(a){if(!(767>=window.innerWidth)){var b=a.ak,c=z.ju(b);a.ui();a=a.U();var d=z.ju(a),e=window.innerHeight,g=window.innerWidth,h=this.xa.query(".js-metabar"),k=0;h&&(k=z.ju(h).height);d.height>=e-k?z.t(a,"floating--sidebar"):(h=z.eu(b),h=c.top+d.height>=e?z.fu().top+e-d.height-10:z.eu(b),b=z.ju(this.Rx).left+10,b+d.width>=g&&(b=g-d.width-10),a.style.top=h+"px",a.style.left=b+"px")}};z.f.zK=function(){z.qd(this.Ti);this.Ti=null};
z.f.c8=function(a){var b=z.Kt(a.target,function(a){return z.Lc(a,"js-paragraphControl")},this.ST),b=Wwa(this.Gf,a.value,b);Y$(this,a.value,null,null,null,b)};z.f.DU=function(a,b){if(this.za.ad()){var c=z.eh();this.zD=(c=c&&Dwa(this.Cd,z.dg(c)))&&new z$(c)}$wa(this,a,b)};z.f.Y9=function(a,b){$wa(this,a,b);if(this.za.ad()&&this.zD){var c=this.zD.restore();c&&c.select()}this.zD=null};
z.f.pr=function(a){if(this.Cd&&(a=M$(this.Cd,a))){a=Math.max(z.eu(a),0);var b=window.document.body;this.Ui&&this.Ui.cancel();this.Ui=new z.TD(b,"scrollTop",600,a)}};bxa.prototype.xE=function(a,b,c){return new X$(a,b,c)};z.da($$,z.R);z.f=$$.prototype;z.f.se=function(a){this.ea=a};z.f.Aga=function(a){this.VK=a};z.f.V=function(){this.U()?(z.R.prototype.V.call(this),z.U(this.U()).o("show-other-responses",this.RU,this),z.O(this.U(),cxa,{post:this.ea}),this.ea.Bp()&&z.r(z.q(z.q(z.q(Gva(this.Ba,this.ea.Ia(),"best"),this.nU.bind(this,"best")),this.K9,this),function(){this.EL.BP&&this.RU()},this),z.Q)):z.Q("Attempted to initialize ResponsesStreamControl without root element.")};
z.f.ga=function(){z.U(this.U()).clear("show-other-responses");z.R.prototype.ga.call(this)};z.f.nU=function(a,b){if(this.isActive()){var c=b.Qf,d=void 0;"best"==a?(d=this.query(".js-responsesStream"),z.Zu(this,c,"add",this.pT.bind(this,c)),this.pT(c)):d=this.query(".js-responsesStreamOther");c&&(z.Tk()||0<c.fd())&&d&&(z.O(d,z.DS,{items:z.WF(c),context:2}),c=new z.IU(this.X,c),c.Ha(d),c.Hg(2),this.track(c),z.Wt(this.query(".js-responsesStreamWrapper")))}};
z.f.K9=function(){var a=this.query(".js-inlineNewPostControl"),b=this.query(".js-responsesLoggedOutPrompt");if(z.Tk())if(a){var b=(new z.o_(this.X)).yA("web-inline-post-response").CA(this.ea.Ia()),c=z.mt(z.No,{post:this.ea,oG:!0});b.cD=c;b.Gy=this.VK;this.nd=b.Ha(a);this.track(this.nd)}else b&&this.VK&&(a=z.du(b),b=z.eu(b),z.bu(a,0,b));else b&&z.t(b,"u-hide")};
z.f.RU=function(){this.$J||(this.$J=z.wc(z.q(z.q(Gva(this.Ba,this.ea.Ia(),"other"),this.nU.bind(this,"other")),function(){z.Qt(this.query(".js-showOtherResponses"));this.EL.BP=!0},this),function(){this.$J=null},this))};z.f.pT=function(a){(a=a.ej)&&a.next&&"other"==a.next.filter&&!this.EL.BP&&(z.Wt(this.query(".js-responsesStreamWrapper")),z.Wt(this.query(".js-showOtherResponses")))};z.f.rv=function(){this.nd&&(z.KT(this.nd.U(),new z.kh(60,0,200,0)),this.nd.rv())};dxa.prototype.Az=function(a){var b=this;return z.q(this.Ba.Az(a),function(a){var d=z.Ra(a.posts);a=a.postPromotion;var e={};e.transitionFooter=z.Ra(d);if(z.Uk(z.v).enable_related_reads_footer_grid_ui&&!z.Uk(z.v).enable_placements&&d){var g=void 0,h=void 0;a?(g=d.length>=b.bo.footerGridWithPromotion,h=b.bo.footerGridWithPromotion):(g=d.length>=b.bo.footerGrid,h=b.bo.footerGrid);e.postPromotion=g?a:null;e.footerGrid=g?z.Va(d,0,h):null}(z.Uk(z.v).enable_read_next_in_metabar||z.Uk(z.v).enable_read_next_mobile_carousel||
z.Uk(z.v).enable_post_transition_footer)&&d&&(e.metabar=z.Va(d,0,b.bo.metabar),e.transitionFooter=e.metabar);(z.Uk(z.v).enable_related_reads_side_card||z.Uk(z.v).enable_related_reads_side_card_fixed||z.Uk(z.v).enable_read_next_mobile_carousel)&&d&&(e.sideCard=z.Va(d,0,b.bo.sideCard));(z.Uk(z.v).enable_related_reads_header_promo||z.Uk(z.v).enable_read_next_mobile_carousel)&&d&&(e.topCard=z.Va(d,0,b.bo.topCard));(z.Uk(z.v).enable_related_reads_footer_promo||z.Uk(z.v).enable_related_reads_footer_promo_always_shown||
z.Uk(z.v).enable_read_next_mobile_carousel)&&d&&(e.bottomCard=z.Va(d,0,b.bo.bottomCard));return e},this)};var exa=z.gA,fxa=exa.Da();fxa.scope("screen").add("quotes",cwa).add("quote-responses",bxa).add("responses-stream-control",$$).add("notes-data",G$).add("related-reads-stream-control",L$).add("related-reads-data-manager",dxa).add("related-reads-recirculation-control",A$);z.KQ(fxa.scope("app"),"PlacementsControl",K$);z.LQ(exa,"notes");}).call(this, _mdm);
//# sourceURL=fingerprint:notes
